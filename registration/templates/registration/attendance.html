{% extends 'base.html' %}
{% load static %}

{% block style %}
<link rel="stylesheet" href="{% static 'css/attendance.css' %}">
{% endblock style %}

{% block dashboard %}
<div class="content-container m-2">
    <h2 class="heading m-2">Mark Batch Attendance</h2>
    <div class="batch-buttons">

        {% if request.user.teachers %}
            {% for cls, batches in class_batches.items %}
                <h4 class="heading m-2">{{ cls }}</h4>
                {% for batch in batches %}
                    {% if batch in user.teachers.batches.all %}
                        <a href="{% url 'mark_attendance' batch.id  %}" class="m-1 btn btn-warning ">{{batch}} - {{batch.attendance.last.date|date:"d M"}} </a>
                    {% else %}
                        <a href="{% url 'mark_attendance' batch.id  %}" class="m-1 btn btn-warning disabled">{{batch}} - {{batch.attendance.last.date|date:"d M"}} </a>
                    {% endif %}
                {% endfor %}
            {% endfor %}

        {% elif request.user.is_superuser %}
            {% for cls, batches in class_batches.items %}
                <h4 class="heading m-2">{{ cls }}</h4>
                {% for batch in batches %}
                    <a href="{% url 'mark_attendance' batch.id  %}" class="m-1 btn btn-warning ">{{batch}} - {{batch.attendance.last.date|date:"d M"}} </a>
                {% endfor %}
            {% endfor %}

        {% endif %}
    </div>
    
    <h2 class="heading m-2">Get Attendance</h2>
    <div class="batch-buttons">

        {% if request.user.teachers %}
            {% for cls, batches in class_batches.items %}
                <h4 class="heading m-2">{{ cls }}</h4>
                {% for batch in batches %}
                    {% if batch in user.teachers.batches.all %}
                        <a href="{% url 'get_attendance' batch.id %}" class="m-1 btn btn-success ">{{batch}} - {{batch.attendance.last.date|date:"d M"}}</a>
                    {% else %}
                        <a href="{% url 'get_attendance' batch.id %}" class="m-1 btn btn-success disabled">{{batch}} - {{batch.attendance.last.date|date:"d M"}}</a>
                    {% endif %}
                {% endfor %}
            {% endfor %}

        {% elif request.user.is_superuser %}
            {% for cls, batches in class_batches.items %}
                <h4 class="heading m-2">{{ cls }}</h4>
                {% for batch in batches %}
                    <a href="{% url 'get_attendance' batch.id %}" class="m-1 btn btn-success ">{{batch}} - {{batch.attendance.last.date|date:"d M"}}</a>
                {% endfor %}
            {% endfor %}
        {% endif %}
    </div>
 
    <h2 class="heading m-2">Mark Batch Homework</h2>
    <div class="batch-buttons">

        {% if request.user.teachers %}
            {% for cls, batches in class_batches.items %}
                <h4 class="heading m-2">{{ cls }}</h4>
                {% for batch in batches %}
                    {% if batch in user.teachers.batches.all %}
                        <a href="{% url 'mark_homework' batch.id  %}" class="m-1 btn btn-warning ">{{batch}} - {{batch.attendance.last.date|date:"d M"}}</a>
                    {% else %}
                        <a href="{% url 'mark_homework' batch.id  %}" class="m-1 btn btn-warning disabled">{{batch}} - {{batch.attendance.last.date|date:"d M"}}</a>
                    {% endif %}
                {% endfor %}
            {% endfor %}
        {% elif request.user.is_superuser %}
            {% for cls, batches in class_batches.items %}
                <h4 class="heading m-2">{{ cls }}</h4>
                {% for batch in batches %}
                    <a href="{% url 'mark_homework' batch.id  %}" class="m-1 btn btn-warning ">{{batch}} - {{batch.attendance.last.date|date:"d M"}}</a>
                {% endfor %}
            {% endfor %}
        {% endif %}
    </div>
    
    <h2 class="heading m-2">Get Homework</h2>
    <div class="batch-buttons">
        {% if request.user.teachers %}
            {% for cls, batches in class_batches.items %}
                <h4 class="heading m-2">{{ cls }}</h4>
                {% for batch in batches %}
                    {% if batch in user.teachers.batches.all %}
                        <a href="{% url 'get_homework' batch.id %}" class="m-1 btn btn-success ">{{batch}} - {{batch.attendance.last.date|date:"d M"}}</a>
                    {% else %}
                        <a href="{% url 'get_homework' batch.id %}" class="m-1 btn btn-success disabled">{{batch}} - {{batch.attendance.last.date|date:"d M"}}</a>
                    {% endif %}
                {% endfor %}
            {% endfor %}
        {% elif request.user.is_superuser %}
            {% for cls, batches in class_batches.items %}
                <h4 class="heading m-2">{{ cls }}</h4>
                {% for batch in batches %}
                    <a href="{% url 'get_homework' batch.id %}" class="m-1 btn btn-success ">{{batch}} - {{batch.attendance.last.date|date:"d M"}}</a>
                {% endfor %}
            {% endfor %}
        {% endif %}
    </div>


</div>  

{% endblock dashboard %}